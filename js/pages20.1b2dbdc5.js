(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages20"],{"74ef":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("list-with-search",{ref:"listWithSearch",attrs:{remoteMethod:t.getReportList,pages:!0},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.data;return[a("cui-table",{attrs:{data:n}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80px",align:"center"}}),a("el-table-column",{attrs:{prop:"target_type",label:"投诉类型",width:"120px",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row.target_type;return[a("el-tag",{attrs:{type:t.targetType[n]["tag"]}},[t._v(t._s(t.targetType[n]["name"]))])]}}],null,!0)}),a("el-table-column",{attrs:{label:"投诉对象","header-align":"center","min-width":"240"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return["user"===n.target_type?a("div",{staticClass:"cui-userbox cui-userbox--large"},[a("img",{directives:[{name:"pic",rawName:"v-pic",value:{img:n.target_user.avatar},expression:"{ img: row.target_user.avatar }"}],staticClass:"cui-userbox__avatar"}),a("p",{staticClass:"cui-userbox__name t-left"},[a("span",[t._v(t._s(n.target_user.name))]),a("br"),a("span",[t._v(t._s(n.target_user.phone))])])]):t._e(),"group"===n.target_type?a("div",{staticClass:"cui-userbox cui-userbox--large"},[a("img",{directives:[{name:"pic",rawName:"v-pic",value:{img:n.group.avatar},expression:"{ img: row.group.avatar }"}],staticClass:"cui-userbox__avatar"}),a("p",{staticClass:"cui-userbox__name t-left"},[a("span",[t._v(t._s(n.group.name))]),a("br"),a("span",[t._v(t._s(n.group.number))])])]):t._e(),"comment"===n.target_type?[a("a",{staticClass:"t-truncate",staticStyle:{cursor:"pointer"},attrs:{title:"查看动态详情"},on:{click:function(e){return t.editDynamic(n)}}},[a("i",{staticClass:"el-icon-view",staticStyle:{"margin-right":"5px",color:"green"}}),t._v(t._s(n.comment.content||"查看评论内容"))])]:t._e(),"reply"===n.target_type?[a("a",{staticClass:"t-truncate",staticStyle:{cursor:"pointer"},attrs:{title:"查看动态详情"},on:{click:function(e){return t.editDynamic(n)}}},[a("i",{staticClass:"el-icon-view",staticStyle:{"margin-right":"5px",color:"green"}}),t._v(t._s(n.reply.content||"查看回复内容"))])]:t._e(),"dynamic"===n.target_type?[a("a",{staticClass:"t-truncate",staticStyle:{cursor:"pointer"},attrs:{title:"查看动态详情"},on:{click:function(e){return t.editDynamic(n)}}},[a("i",{staticClass:"el-icon-view",staticStyle:{"margin-right":"5px",color:"green"}}),t._v(t._s(n.dynamic.content||"查看动态内容"))])]:t._e()]}}],null,!0)}),a("el-table-column",{attrs:{label:"投诉人",width:"160",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row.user,r=n.avatar,s=n.name,i=n.tel;return[a("div",{staticClass:"cui-userbox cui-userbox--large"},[a("img",{directives:[{name:"pic",rawName:"v-pic",value:{img:r},expression:"{ img: avatar }"}],staticClass:"cui-userbox__avatar"}),a("p",{staticClass:"cui-userbox__name t-left"},[a("span",[t._v(t._s(s))]),a("br"),a("span",[t._v(t._s(i))])])])]}}],null,!0)}),a("el-table-column",{attrs:{prop:"content",label:"投诉内容","header-align":"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row.content;return[a("div",{staticClass:"t-truncate",attrs:{title:n}},[t._v(t._s(n))])]}}],null,!0)}),a("el-table-column",{attrs:{prop:"content",label:"投诉截图",align:"center",width:"220"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row.images;return[n?[a("image-dialog-wrapper",{attrs:{images:n||[]}})]:a("div",{staticClass:"u-help"},[t._v("暂无截图")])]}}],null,!0)}),a("el-table-column",{attrs:{prop:"created_at",label:"投诉时间",width:"100px","header-align":"center"}}),a("el-table-column",{attrs:{label:"状态",width:"80",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row.status;return[a("el-tag",{attrs:{type:t.statusOptions[n]["type"]}},[t._v(t._s(t.statusOptions[n]["name"]))])]}}],null,!0)}),a("el-table-column",{attrs:{prop:"updated_at",label:"审核时间","header-align":"center",width:"100px"}}),a("el-table-column",{attrs:{label:"审核员",align:"center",width:"100px"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row.admin;return[a("span",[t._v(t._s(n?n.name:"--"))])]}}],null,!0)}),a("el-table-column",{attrs:{label:"操作",width:"200",align:"center",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row;return[0!==n.status?[a("el-tooltip",{attrs:{placement:"bottom-end"}},[a("span",{attrs:{slot:"content"},slot:"content"},[t._v(t._s(n.extend&&n.extend.reason||"暂无理由"))]),a("span",[t._v(t._s(1===n.status?"处理方式":"驳回理由")),a("i",{staticClass:"c-danger el-icon-info",staticStyle:{"margin-left":"3px"}})])])]:[a("el-button-group",[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-check"},on:{click:function(e){return t.passOrRejectHandle(n,"pass")}}},[t._v("通过")]),a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-close"},on:{click:function(e){return t.passOrRejectHandle(n,"reject")}}},[t._v("驳回")])],1)]]}}],null,!0)})],1)]}}])})},r=[],s=(a("7f7f"),a("96cf"),a("3b8d")),i=(a("ac6a"),a("5df3"),a("f400"),a("f9a8")),c=a.n(i),l=a("a8db"),o=a("c1fb");function u(t){return o["a"].get("report",{params:t})}function p(t){var e=t.id,a=t.action,n=Object(l["a"])(t,["id","action"]);return o["a"].put("report/".concat(e,"/").concat(a),n)}var m=a("054f"),d=a("11c1"),g=a("db3c"),_={name:"Privilege",components:{listWithSearch:d["a"],dynamicItem:g["a"]},data:function(){return{defaultAvatar:c.a,actionsMap:new Map([["pass",{label:"通过",status:1}],["reject",{label:"驳回",status:2}]]),statusOptions:[{type:"warning",name:"待处理"},{type:"success",name:"已通过"},{type:"danger",name:"已驳回"}],targetType:{dynamic:{tag:"success",name:"动态"},comment:{tag:"",name:"评论"},user:{tag:"info",name:"用户"},reply:{tag:"warning",name:"回复"},group:{tag:"warning",name:"社区（群）"},task:{tag:"",name:"任务"}}}},methods:{getImageUrlByKey:m["b"],getReportList:u,editDynamic:function(t){this.$router.push({name:"dynamic",params:{row:t}})},updateDataHandle:function(){this.$refs["listWithSearch"]&&this.$refs["listWithSearch"].updateDataHandle()},passOrRejectHandle:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(e,a){var n,r,s,i,c=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n="reject"===a?"驳回":"通过",r="投诉通过",t.prev=2,t.next=5,this.$prompt("请输入".concat(n,"理由, 10-20字内"),"投诉".concat(n),{inputPattern:/\S/,inputType:"textarea",inputErrorMessage:"".concat(n,"理由不能为空！")});case 5:r=t.sent,r=r.value,t.next=12;break;case 9:return t.prev=9,t.t0=t["catch"](2),t.abrupt("return",!1);case 12:s=this.actionsMap.get(a),i=s.label,this.$confirm("确认".concat(i,"用户「").concat(e.user.name,"」的投诉"),"".concat(i,"投诉")).then(function(){p({id:e.id,action:a,reason:r}).then(function(t){var e=t.message,a=void 0===e?"".concat(i,"投诉操作成功！"):e;c.$message.success(a),c.updateDataHandle()}).catch(function(t){var e=t.message,a=void 0===e?"".concat(i,"投诉操作失败！"):e;c.$message.error(a)})}).catch(function(){});case 14:case"end":return t.stop()}},t,this,[[2,9]])}));function e(e,a){return t.apply(this,arguments)}return e}(),avatarError:function(t){t.target.src=c.a}}},f=_,v=a("2877"),b=Object(v["a"])(f,n,r,!1,null,null,null);e["default"]=b.exports}}]);