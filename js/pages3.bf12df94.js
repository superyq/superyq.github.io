(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages3"],{"11c1":function(t,e,a){"use strict";var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"cui-page"},[t.$slots["header"]?a("div",{staticClass:"cui-page-header"},[t._t("header")],2):t._e(),t._t("default",null,null,{data:t.data}),t.pages&&!t.scroll?a("div",{staticClass:"cui-page-footer"},[a("cui-pagination",{attrs:{total:t.total,limit:t.limit,current:t.page},on:{"size-change":t.limitChangeHandle,"current-change":t.pageChangeHandle}})],1):t._e()],2)},i=[],n=(a("96cf"),a("3b8d")),s=a("cebc"),c=a("20ca"),o={name:"listWithSearch",props:{scroll:Boolean,pages:Boolean,searchParams:Object,remoteMethod:{type:Function,required:!0},formatResponse:Function},data:function(){return{data:[],page:1,total:0,limit:20,loading:!1,isBottom:!1}},methods:{changeItem:function(t,e){this.$set(this.data,t,Object(s["a"])({},this.data[t],e))},deleteItem:function(t){this.data.splice(t,1)},searchHandle:function(){this.data=[],this.page=1,this.updateDataHandle()},updateDataHandle:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.loading){t.next=2;break}return t.abrupt("return");case 2:return this.loading=!0,t.next=5,this.formatSearchParams();case 5:return e=t.sent,t.prev=6,t.next=9,this.remoteMethod(e).then(this.formatSearchResult);case 9:a=t.sent,this.$emit("updateSuccess",a),t.next=16;break;case 13:t.prev=13,t.t0=t["catch"](6),this.$emit("updateFailed",t.t0);case 16:this.loading=!1;case 17:case"end":return t.stop()}},t,this,[[6,13]])}));function e(){return t.apply(this,arguments)}return e}(),formatSearchParams:function(){var t={};return this.pages&&Object.assign(t,{page:this.page,limit:this.limit}),this.searchParams&&Object.assign(t,this.searchParams),t},formatSearchResult:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e){var a,r,i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!this.formatResponse){t.next=4;break}return t.next=3,this.formatResponse(e);case 3:e=t.sent;case 4:return a=e,r=a.data,this.pages?(i=r.total,n=r.data,this.scroll?(this.isBottom=n.length<this.limit,this.data=this.data.concat(n)):this.data=n,this.total=i):this.data=r,t.abrupt("return",e);case 7:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),limitChangeHandle:function(t){this.limit=t,this.updateDataHandle()},pageChangeHandle:function(t){this.page=t,this.updateDataHandle()},scrollHandle:Object(c["a"])(function(){if(!this.isBottom){var t=document.documentElement.offsetHeight-document.documentElement.scrollTop-window.innerHeight<=200;t&&(this.page+=1,this.updateDataHandle())}},1e3),resetScroll:function(){var t=this;window.removeEventListener("scroll",this.scrollHandle,!1),this.$nextTick(function(){window.addEventListener("scroll",t.scrollHandle,!1)})}},mounted:function(){this.scroll&&window.addEventListener("scroll",this.scrollHandle,!1),this.updateDataHandle()},destroyed:function(){this.scroll&&window.removeEventListener("scroll",this.scrollHandle,!1)}},l=o,u=a("2877"),d=Object(u["a"])(l,r,i,!1,null,null,null);e["a"]=d.exports},"6b09":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("list-with-search",{ref:"wrapper",staticClass:"page-dynamic page-certification",attrs:{pages:"",scroll:"","remote-method":t.remoteMethod,"search-params":t.search},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.data;return[a("div",{staticClass:"card-box clearfix"},[t._l(r,function(e){return a("certification-card",{key:e.id,attrs:{item:e},on:{passOrRejectHandle:t.passOrRejectHandle,showImage:t.showImageHandle}})}),a("image-dialog-wrapper",{ref:"imageDialog",attrs:{images:t.item||[],onlyDialog:!0}})],2)]}}])},[a("template",{slot:"header"},[a("el-form",{attrs:{slot:"header",size:"mini",inline:!0,model:t.search,"label-suffix":"："},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.searchHandle(e)},submit:function(t){t.preventDefault()}},slot:"header"},[a("el-form-item",[a("el-input",{attrs:{placeholder:"请输入用户名查询",clearable:""},model:{value:t.search.user_name,callback:function(e){t.$set(t.search,"user_name",e)},expression:"search.user_name"}},[a("span",{attrs:{slot:"prepend"},slot:"prepend"},[t._v("用户名")])])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchHandle}},[t._v("查询")])],1),a("el-form-item",[a("el-radio-group",{staticStyle:{"margin-left":"15px"},attrs:{size:"mini"},on:{change:t.searchHandle},model:{value:t.search.status,callback:function(e){t.$set(t.search,"status",e)},expression:"search.status"}},[a("el-radio",{attrs:{label:null}},[t._v("全部")]),a("el-radio",{attrs:{label:0}},[t._v("待审核")]),a("el-radio",{attrs:{label:1}},[t._v("已通过")]),a("el-radio",{attrs:{label:2}},[t._v("已驳回")])],1)],1),a("el-form-item",{staticClass:"f-right",attrs:{label:"认证总数"}},[a("span",{staticStyle:{"font-size":"35px",color:"burlywood"}},[t._v(t._s(t.total))])])],1)],1)],2)},i=[],n=(a("7f7f"),a("96cf"),a("3b8d")),s=(a("ac6a"),a("5df3"),a("f400"),a("11c1")),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"card"},[a("div",{staticClass:"card__status",style:{color:t.color,background:t.background,border:t.border,cursor:t.cursor}},[2!==t.status?a("span",[t._v(t._s(t.statusName))]):a("el-popover",{attrs:{placement:"bottom",title:"驳回理由",width:"200",trigger:"click",content:t.item.data.reason||"暂无理由"}},[a("span",{attrs:{slot:"reference"},slot:"reference"},[t._v(t._s(t.statusName)),a("i",{staticClass:"el-icon-d-arrow-right"})])])],1),a("div",{staticClass:"card__user-info"},[a("div",{staticClass:"card__user-avatar u-img-box f-left"},[a("img",{directives:[{name:"pic",rawName:"v-pic",value:{img:t.item.user.avatar,error:t.defaultUserAvatar},expression:"{ img: item.user.avatar, error: defaultUserAvatar }"}]})]),a("div",{staticClass:"card__user-content f-left"},[a("p",[t._v(t._s(t.item.user.name))]),a("p",[t._v(t._s(t.item.user.phone))])])]),a("div",{staticClass:"card__identity-info"},[a("div",{staticClass:"card__identity-info-text"},[a("p",[t._v("姓名："+t._s(t.item.data.name))]),a("p",[t._v("身份证："+t._s(t.item.data.number))]),a("p",[t._v("申请时间："+t._s(t.item.created_at||"--"))])]),a("div",{staticClass:"card__identity-info-pic"},[a("div",{staticClass:"certification-pic u-img-box f-left",on:{click:function(e){return t.showImageHandle(0)}}},[a("img",{directives:[{name:"pic",rawName:"v-pic",value:{img:t.item.data.front},expression:"{ img: item.data.front }"}]})]),a("div",{staticClass:"certification-pic u-img-box f-right",on:{click:function(e){return t.showImageHandle(1)}}},[a("img",{directives:[{name:"pic",rawName:"v-pic",value:{img:t.item.data.back},expression:"{ img: item.data.back }"}]})])])]),a("div",{staticClass:"card__line"}),a("div",{staticClass:"card__Auditor-info"},[a("p",[t._v("审核员："+t._s(t.item.admin?t.item.admin.name:"--"))]),a("p",[t._v("审核时间："+t._s(t.item.updated_at||"--"))])]),a("div",{staticClass:"card__control-info"},[a("el-button",{staticClass:"f-left",attrs:{type:"primary",icon:"el-icon-check",disabled:0!==t.item.status,round:""},on:{click:function(e){return t.passOrRejectHandle(t.item,"pass")}}},[t._v("通过")]),a("el-button",{staticClass:"f-right",attrs:{type:"danger",icon:"el-icon-close",disabled:0!==t.item.status,round:""},on:{click:function(e){return t.passOrRejectHandle(t.item,"reject")}}},[t._v("驳回")])],1)])},o=[],l=a("f9a8"),u=a.n(l),d=a("054f"),m={name:"CertificationCard",props:{item:{type:Object,required:!0}},data:function(){return{defaultUserAvatar:u.a,statusOptions:["待审核","已通过","已驳回"]}},computed:{status:function(){return this.item.status},color:function(){return this.status?"#fff":"#00A0E9"},background:function(){var t="#fff";switch(this.status){case 0:t="#fff";break;case 1:t="#00A0E9";break;case 2:t="#F57373";break}return t},border:function(){return"1px solid ".concat(this.color)},cursor:function(){return 2===this.status?"pointer":"auto"},statusName:function(){return this.statusOptions[this.item.status]}},methods:{showImageHandle:function(t){this.$emit("showImage",this.item,t)},getImageUrlByKey:d["b"],passOrRejectHandle:function(t,e){this.$emit("passOrRejectHandle",t,e)}}},f=m,h=a("2877"),p=Object(h["a"])(f,c,o,!1,null,null,null),g=p.exports,v=a("a8db"),b=a("c1fb");function _(t){return b["a"].get("certifications",{params:t})}function w(t){var e=t.id,a=t.action,r=Object(v["a"])(t,["id","action"]);return b["a"].put("certifications/".concat(e,"/").concat(a),r)}var x=a("ed08"),k={name:"Certification",components:{listWithSearch:s["a"],certificationCard:g},data:function(){return{total:0,search:{user_name:"",status:null},actionsMap:new Map([["pass",{label:"通过",status:1}],["reject",{label:"驳回",status:2}]]),item:[]}},methods:{showImageHandle:function(t,e){var a=t.data,r=a.front,i=a.back;this.item=[{filename:r},{filename:i}],this.$refs["imageDialog"]&&this.$refs["imageDialog"].showDialog(e)},remoteMethod:function(){var t=this;return _(arguments.length<=0?void 0:arguments[0]).then(function(e){var a=e.data.total;return t.total=a,e})},searchHandle:function(){this.$refs["wrapper"].searchHandle()},passOrRejectHandle:function(){var t=Object(n["a"])(regeneratorRuntime.mark(function t(e,a){var r,i,n,s=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(r="认证通过","reject"!==a){t.next=12;break}return t.prev=2,t.next=5,this.$prompt("请输入驳回理由, 10-20字内","认证驳回",{inputPattern:/\S/,inputType:"textarea",inputErrorMessage:"驳回理由不能为空！"});case 5:r=t.sent,r=r.value,t.next=12;break;case 9:return t.prev=9,t.t0=t["catch"](2),t.abrupt("return",!1);case 12:i=this.actionsMap.get(a),n=i.label,this.$confirm("确认".concat(n,"用户「").concat(e.user.name,"」的实名认证"),"".concat(n,"实名认证")).then(function(){w({id:e.id,action:a,reason:r}).then(function(){s.$message.success("".concat(n,"实名认证操作成功！")),s.searchHandle()}).catch(function(t){var e=t.message,a=void 0===e?"".concat(n,"实名认证操作失败！"):e;s.$message.error(a)})}).catch(x["i"]);case 14:case"end":return t.stop()}},t,this,[[2,9]])}));function e(e,a){return t.apply(this,arguments)}return e}()},activated:function(){this.$refs["wrapper"]&&this.$refs["wrapper"].resetScroll()}},H=k,y=Object(h["a"])(H,r,i,!1,null,null,null);e["default"]=y.exports},a8db:function(t,e,a){"use strict";var r=a("e265"),i=a.n(r),n=a("a4bb"),s=a.n(n);function c(t,e){if(null==t)return{};var a,r,i={},n=s()(t);for(r=0;r<n.length;r++)a=n[r],e.indexOf(a)>=0||(i[a]=t[a]);return i}function o(t,e){if(null==t)return{};var a,r,n=c(t,e);if(i.a){var s=i()(t);for(r=0;r<s.length;r++)a=s[r],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(n[a]=t[a])}return n}a.d(e,"a",function(){return o})},f9a8:function(t,e,a){t.exports=a.p+"img/avatar__user.d76349f5.png"}}]);