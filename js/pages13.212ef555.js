(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages13"],{"386d":function(t,e,a){"use strict";var n=a("cb7c"),i=a("83a1"),r=a("5f1b");a("214f")("search",1,function(t,e,a,s){return[function(a){var n=t(this),i=void 0==a?void 0:a[e];return void 0!==i?i.call(a,n):new RegExp(a)[e](String(n))},function(t){var e=s(a,t,this);if(e.done)return e.value;var c=n(t),o=String(this),l=c.lastIndex;i(l,0)||(c.lastIndex=0);var u=r(c,o);return i(c.lastIndex,l)||(c.lastIndex=l),null===u?-1:u.index}]})},"83a1":function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t===1/e:t!=t&&e!=e}},"9aa7":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"data-chart",staticStyle:{width:"100%",height:"100%"}})},i=[],r=a("164e"),s=a.n(r),c={name:"data-chart",props:{options:{type:Object,required:!0}},data:function(){return{chart:null}},watch:{options:function(){this.clearChart(),this.reloadChart()}},methods:{clearChart:function(){this.chart.clear()},reloadChart:function(){this.chart.setOption(this.options)},resizeChart:function(){this.chart.resize()}},mounted:function(){var t=this;this.chart=s.a.init(this.$el),this.$nextTick(function(){t.reloadChart()})},beforeDestroy:function(){}},o=c,l=a("2877"),u=Object(l["a"])(o,n,i,!1,null,null,null);e["a"]=u.exports},a8db:function(t,e,a){"use strict";var n=a("e265"),i=a.n(n),r=a("a4bb"),s=a.n(r);function c(t,e){if(null==t)return{};var a,n,i={},r=s()(t);for(n=0;n<r.length;n++)a=r[n],e.indexOf(a)>=0||(i[a]=t[a]);return i}function o(t,e){if(null==t)return{};var a,n,r=c(t,e);if(i.a){var s=i()(t);for(n=0;n<s.length;n++)a=s[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(r[a]=t[a])}return r}a.d(e,"a",function(){return o})},ae08:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"invitation",attrs:{center:"",fullscreen:"","ppend-to-body":"",visible:t.visible,"close-on-click-modal":!1,"show-close":!1},on:{"update:visible":function(e){t.visible=e}}},[a("div",{staticClass:"statistics__header",attrs:{slot:"title"},slot:"title"},[a("h2",[t._v("【"+t._s(t.title)+"】数据统计")]),a("el-button",{attrs:{type:"warning"},on:{click:function(e){t.visible=!1}}},[t._v("返回")])],1),a("div",{staticClass:"statistics__body"},[a("el-row",{attrs:{gutter:30}},[a("el-col",{attrs:{lg:16,md:24}},[a("echarts-people",{attrs:{num_analysis:t.num_analysis}})],1),a("el-col",{attrs:{lg:8,md:24}},[a("echarts-reward",{attrs:{reward_records:t.reward_records}})],1)],1),a("el-row",[a("receive-table",{attrs:{all_data:t.all_data},on:{exportData:t.exportData,searchHandle:t.searchHandle}}),a("cui-pagination",{staticStyle:{"margin-top":"10px"},attrs:{total:t.total,limit:t.limit,current:t.page},on:{"size-change":t.limitChangeHandle,"current-change":t.pageChangeHandle}})],1)],1)])},i=[],r=a("cebc"),s=(a("96cf"),a("3b8d")),c=(a("7f7f"),a("b7d5")),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"statistics-card",staticStyle:{height:"420px"}},[a("div",{staticClass:"title"},[t._v("活动人数分析")]),a("data-chart",{attrs:{options:t.optoins}})],1)},l=[],u=a("9aa7"),d={trigger:"axis",formatter:function(t){for(var e="",a=0;a<t.length;a++){var n=t[a],i=n.name,r=n.seriesName,s=n.value,c=n.color;0===a&&(e+=i+"<br/>"),e+="<div>\n                    <span style='margin-right:5px;display:inline-block;width:10px;height:10px;border-radius:5px;border: 1px solid #fff;background-color:".concat(c,";'>\n                    </span>\n                    ").concat(r,"：").concat(s,"\n                  </div>")}return e},backgroundColor:"rgba(0,182,206,0.8)",padding:[10,20,10,10]},h={top:"10%",left:"1%",right:"0%",bottom:"10%",containLabel:!0},p=["#578CFF","#52C9B0"],m={color:p,tooltip:d,grid:h,yAxis:{name:"人数(位)",nameTextStyle:{color:"#999",fontSize:16},type:"value",axisLine:{show:!1},axisTick:{show:!1}},legend:{itemHeight:9,itemGap:30,data:[{name:"注册用户",icon:"circle",textStyle:{color:"#999"}},{name:"有效用户",icon:"circle",textStyle:{color:"#999"}}]}},f=["#00B6CE","#578CFF","#FFC53D"],v={color:f,grid:h,tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",x:"right",data:["首得CT奖励","一键收取奖励","大额CT奖励"]}},b={name:"echarts-people",components:{dataChart:u["a"]},props:{num_analysis:{type:Object,required:!0}},computed:{xKey:function(){var t=this.num_analysis.register_num;return t&&t.map(function(t){return t.date})},xVal:function(){var t=this.num_analysis,e=[];for(var a in t){var n=[];switch(a){case"register_num":for(var i in t[a])n.push(t[a][i].num);e.push({name:"注册用户",type:"line",data:n});break;case"valid_num":for(var r in t[a])n.push(t[a][r].num);e.push({name:"有效用户",type:"line",data:n});break}}return e},optoins:function(){var t=this.xKey,e=this.xVal;return Object(r["a"])({},m,{xAxis:{type:"category",axisTick:{alignWithLabel:!0,show:!1},axisLine:{show:!1},data:t},series:e})}}},g=b,_=a("2877"),x=Object(_["a"])(g,o,l,!1,null,null,null),w=x.exports,y=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"statistics-card",staticStyle:{height:"420px"}},[a("div",{staticClass:"title"},[t._v("奖品领取情况")]),a("data-chart",{attrs:{options:t.optoins}})],1)},C=[],k={name:"echarts-reward",components:{dataChart:u["a"]},props:{reward_records:{type:Object,required:!0}},computed:{xVal:function(){var t=this.reward_records,e=[];for(var a in t)switch(a){case"ct":e.push({name:"大额CT奖励",value:t[a]});break;case"first":e.push({name:"首得CT奖励",value:t[a]});break;case"yjsq":e.push({name:"一键收取奖励",value:t[a]});break}return e},optoins:function(){var t=this.xVal;return Object(r["a"])({},v,{series:[{name:"奖励来源",type:"pie",radius:["0","70%"],avoidLabelOverlap:!1,label:{normal:{formatter:"{c}",position:"inside"}},labelLine:{normal:{show:!1}},data:t}]})}}},O=k,j=Object(_["a"])(O,y,C,!1,null,null,null),$=j.exports,S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"statistics-card"},[a("div",{staticClass:"title"},[t._v("领取记录")]),a("div",{staticClass:"numbers"},[a("span",[t._v("用户名称："),a("el-input",{staticStyle:{width:"160px",margin:"0 20px"},attrs:{placeholder:"支持模糊查询",clearable:""},model:{value:t.search.user,callback:function(e){t.$set(t.search,"user",e)},expression:"search.user"}}),a("el-button",{staticStyle:{"margin-right":"20px"},on:{click:t.searchHandle}},[t._v("查询")])],1),a("span",[t._v("参与人数："),a("b",[t._v(t._s(t.join_total_num))])]),a("span",{staticStyle:{"margin-left":"60px"}},[t._v("有效人数："),a("b",[t._v(t._s(t.valid_total_num))])]),a("el-button",{staticClass:"f-right",attrs:{type:"text",icon:"el-icon-paperclip"},on:{click:t.exportDataHandle}},[t._v("导出")])],1),a("el-table",{attrs:{data:t.list,stripe:""}},[a("el-table-column",{attrs:{label:"用户名称",prop:"user.name",align:"center"}}),a("el-table-column",{attrs:{label:"邀请用户",prop:"regsiter_num",align:"center"}}),a("el-table-column",{attrs:{label:"有效用户",prop:"effective_num",align:"center"}}),a("el-table-column",{attrs:{label:"虚拟用户",prop:"virtual_num",align:"center"}}),a("el-table-column",{attrs:{label:"领取奖励",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row.reward_info;return[t._v(t._s(a))]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.row,i=e.$index;return[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.eidtNumber(n,i)}}},[t._v("修改虚拟用户")])]}}])},[t.visible?a("user-number",{ref:"userNumber",on:{submit:t.submit}}):t._e()],1)],1)],1)},H=[],T=(a("386d"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"修改【"+t.name+"】的虚拟用户",visible:t.visible,width:"30%","append-to-body":""},on:{"update:visible":function(e){t.visible=e}}},[a("el-input-number",{attrs:{precision:0,step:1,min:0},model:{value:t.num,callback:function(e){t.num=e},expression:"num"}}),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("确 定")])],1)],1)}),E=[],D={name:"user-number",data:function(){return{row:null,index:0,id:0,name:"",num:0,visible:!1}},methods:{reset:function(){this.id=0,this.num=0,this.name=""},init:function(t,e){this.visible=!0,this.row=t,this.index=e,this.reset();var a=t.id,n=t.user.name,i=t.virtual_num;this.id=a,this.name=n,this.num=i},submit:function(){this.visible=!1,this.$emit("submit",this.row,this.index,this.num)}}},N=D,F=Object(_["a"])(N,T,E,!1,null,null,null),L=F.exports,R={name:"receive-table",components:{userNumber:L},props:{all_data:{type:Object,required:!0}},data:function(){return{visible:!1,search:{user:""}}},computed:{list:function(){return this.all_data.get_records&&this.all_data.get_records.data},join_total_num:function(){return this.all_data.join_total_num},valid_total_num:function(){return this.all_data.valid_total_num}},methods:{searchHandle:function(){this.$emit("searchHandle",this.search)},exportDataHandle:function(){this.$emit("exportData")},eidtNumber:function(t,e){var a=this;this.visible=!0,this.$nextTick(function(){a.$refs["userNumber"]&&a.$refs["userNumber"].init(t,e)})},submit:function(t,e,a){var n=this,i=t.id;this.$confirm("确认修改虚拟用户数量?","提示").then(function(){Object(c["b"])({id:i,num:a}).then(function(t){var i=t.message,r=void 0===i?"设置成功！":i;n.$message.success(r),n.$set(n.all_data.get_records.data[e],"virtual_num",a)}).catch(function(t){var e=t.message,a=void 0===e?"修改失败！":e;n.$message.error(a)})}).catch(function(){})}}},q=R,z=Object(_["a"])(q,S,H,!1,null,null,null),I=z.exports,V={name:"invitation-statistics",components:{echartsPeople:w,echartsReward:$,receiveTable:I},data:function(){return{visible:!1,loading:!1,invitation:{},page:1,total:0,limit:10,num_analysis:{},reward_records:{},all_data:{}}},computed:{title:function(){var t=this.invitation||{},e=t.name,a=void 0===e?"":e;return a}},methods:{init:function(t){this.visible=!0,this.invitation=t,this.refresh()},limitChangeHandle:function(t){this.limit=t,this.refresh()},pageChangeHandle:function(t){this.page=t,this.refresh()},searchHandle:function(t){this.refresh(t)},refresh:function(){var t=Object(s["a"])(regeneratorRuntime.mark(function t(){var e,a,n,i=arguments;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=i.length>0&&void 0!==i[0]?i[0]:{},!this.loading){t.next=3;break}return t.abrupt("return");case 3:if(this.loading=!1,a=this.invitation.id,a){t.next=7;break}return t.abrupt("return",this.loading=!1);case 7:return t.prev=7,t.next=10,Object(c["f"])(a,Object(r["a"])({page:this.page,limit:this.limit},e));case 10:n=t.sent,this.num_analysis=n.data.num_analysis,this.reward_records=n.data.reward_records,this.all_data=n.data,this.total=n.data.get_records.total,t.next=19;break;case 17:t.prev=17,t.t0=t["catch"](7);case 19:case"end":return t.stop()}},t,this,[[7,17]])}));function e(){return t.apply(this,arguments)}return e}(),exportData:function(){var t=this;this.$confirm("确认导出该活动数据？","操作确认").then(Object(s["a"])(regeneratorRuntime.mark(function e(){var a,n,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(c["c"])(t.invitation.id);case 3:a=e.sent,n=a.data.download_url,i=document.createElement("a"),i.target="_blank",i.href=n,i.download="".concat(t.title,"-统计数据.xlsx"),i.click(),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](0),t.$message.error(e.t0.msg||"导出失败！");case 15:case"end":return e.stop()}},e,null,[[0,12]])}))).catch(function(){})}}},A=V,P=Object(_["a"])(A,n,i,!1,null,null,null);e["default"]=P.exports},b7d5:function(t,e,a){"use strict";a.d(e,"d",function(){return r}),a.d(e,"h",function(){return s}),a.d(e,"a",function(){return c}),a.d(e,"e",function(){return o}),a.d(e,"g",function(){return l}),a.d(e,"i",function(){return u}),a.d(e,"f",function(){return d}),a.d(e,"c",function(){return h}),a.d(e,"b",function(){return p});var n=a("a8db"),i=a("c1fb");function r(t){return i["a"].get("activities",{params:t})}function s(t){var e=t.id,a=Object(n["a"])(t,["id"]),r={data:a,method:e?"PATCH":"POST",url:"activities/".concat(e||"")};return Object(i["a"])(r)}function c(t){return i["a"].delete("activities/".concat(t))}function o(t){return i["a"].get("activities/".concat(t,"/awards"))}function l(t,e){return i["a"].post("activities/".concat(t,"/awards"),e)}function u(t,e){return i["a"].put("activities/awards/".concat(t),e)}function d(t,e){return i["a"].get("activities/".concat(t,"/statistics"),{params:e})}function h(t){return i["a"].post("activities/".concat(t,"/export"))}function p(t){var e=t.id,a=Object(n["a"])(t,["id"]);return i["a"].post("activities/".concat(e,"/setting-virtual-num"),a)}}}]);