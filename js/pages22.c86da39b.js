(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages22"],{"11c1":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"cui-page"},[e.$slots["header"]?a("div",{staticClass:"cui-page-header"},[e._t("header")],2):e._e(),e._t("default",null,null,{data:e.data}),e.pages&&!e.scroll?a("div",{staticClass:"cui-page-footer"},[a("cui-pagination",{attrs:{total:e.total,limit:e.limit,current:e.page},on:{"size-change":e.limitChangeHandle,"current-change":e.pageChangeHandle}})],1):e._e()],2)},r=[],i=(a("96cf"),a("3b8d")),l=a("cebc"),s=a("20ca"),o={name:"listWithSearch",props:{scroll:Boolean,pages:Boolean,searchParams:Object,remoteMethod:{type:Function,required:!0},formatResponse:Function},data:function(){return{data:[],page:1,total:0,limit:20,loading:!1,isBottom:!1}},methods:{changeItem:function(e,t){this.$set(this.data,e,Object(l["a"])({},this.data[e],t))},deleteItem:function(e){this.data.splice(e,1)},searchHandle:function(){this.data=[],this.page=1,this.updateDataHandle()},updateDataHandle:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.loading){e.next=2;break}return e.abrupt("return");case 2:return this.loading=!0,e.next=5,this.formatSearchParams();case 5:return t=e.sent,e.prev=6,e.next=9,this.remoteMethod(t).then(this.formatSearchResult);case 9:a=e.sent,this.$emit("updateSuccess",a),e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](6),this.$emit("updateFailed",e.t0);case 16:this.loading=!1;case 17:case"end":return e.stop()}},e,this,[[6,13]])}));function t(){return e.apply(this,arguments)}return t}(),formatSearchParams:function(){var e={};return this.pages&&Object.assign(e,{page:this.page,limit:this.limit}),this.searchParams&&Object.assign(e,this.searchParams),e},formatSearchResult:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(t){var a,n,r,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!this.formatResponse){e.next=4;break}return e.next=3,this.formatResponse(t);case 3:t=e.sent;case 4:return a=t,n=a.data,this.pages?(r=n.total,i=n.data,this.scroll?(this.isBottom=i.length<this.limit,this.data=this.data.concat(i)):this.data=i,this.total=r):this.data=n,e.abrupt("return",t);case 7:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),limitChangeHandle:function(e){this.limit=e,this.updateDataHandle()},pageChangeHandle:function(e){this.page=e,this.updateDataHandle()},scrollHandle:Object(s["a"])(function(){if(!this.isBottom){var e=document.documentElement.offsetHeight-document.documentElement.scrollTop-window.innerHeight<=200;e&&(this.page+=1,this.updateDataHandle())}},1e3),resetScroll:function(){var e=this;window.removeEventListener("scroll",this.scrollHandle,!1),this.$nextTick(function(){window.addEventListener("scroll",e.scrollHandle,!1)})}},mounted:function(){this.scroll&&window.addEventListener("scroll",this.scrollHandle,!1),this.updateDataHandle()},destroyed:function(){this.scroll&&window.removeEventListener("scroll",this.scrollHandle,!1)}},c=o,d=a("2877"),u=Object(d["a"])(c,n,r,!1,null,null,null);t["a"]=u.exports},a8db:function(e,t,a){"use strict";var n=a("e265"),r=a.n(n),i=a("a4bb"),l=a.n(i);function s(e,t){if(null==e)return{};var a,n,r={},i=l()(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}function o(e,t){if(null==e)return{};var a,n,i=s(e,t);if(r.a){var l=r()(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}a.d(t,"a",function(){return o})},f27e:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("list-with-search",{ref:"wrapper",attrs:{pages:"","search-params":e.search,"remote-method":e.remoteMethod},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.data;return[a("cui-table",{attrs:{data:n}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"80",align:"center"}}),a("el-table-column",{attrs:{prop:"word",label:"敏感词",align:"center"}}),a("el-table-column",{attrs:{prop:"type",label:"操作类型",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row.type;return[a("el-tag",{attrs:{type:e.typeOpt[n]["tag"]}},[e._v(e._s(e.typeOpt[n]["name"]))])]}}],null,!0)}),a("el-table-column",{attrs:{prop:"replace",label:"替换词",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row.replace;return[e._v(e._s(a||"--"))]}}],null,!0)}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"240px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button-group",[a("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(a){return e.addOrUpdateHandle(t.row)}}},[e._v("修改")]),a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(a){return e.deleteHandle(t.row)}}},[e._v("删除")])],1)]}}],null,!0)})],1),e.addOrUpdateVisible?a("add-or-update",{ref:"addOrUpdate"}):e._e()]}}])},[a("template",{slot:"header"},[a("el-form",{attrs:{model:e.search,size:"small",inline:""}},[a("el-form-item",[a("el-input",{attrs:{clearable:"",placeholder:"请输入敏感词查询"},model:{value:e.search.word,callback:function(t){e.$set(e.search,"word",t)},expression:"search.word"}},[a("span",{attrs:{slot:"prepend"},slot:"prepend"},[e._v("敏感词")])])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.updateTableData()}}},[e._v("查询")]),a("el-button",{attrs:{type:"warning",icon:"el-icon-plus"},on:{click:function(t){return e.addOrUpdateHandle()}}},[e._v("新增")]),a("el-button",{attrs:{type:"success",disabled:e.loading},on:{click:function(t){return e.exportOrImportHandle("import")}}},[e._v("导入")]),a("el-button",{attrs:{type:"warning",disabled:e.loading},on:{click:function(t){return e.exportOrImportHandle("export")}}},[e._v("下载模板")]),a("a",{ref:"sensitive",attrs:{href:"./static/sensitive.xlsx",target:"_blank",download:"敏感词模板.xlsx",hidden:""}}),a("input",{ref:"fileInput",attrs:{hidden:"",type:"file"},on:{change:function(t){return e.fileChangeHandle(t)}}})],1),a("el-form-item",[a("el-radio-group",{staticStyle:{"margin-left":"15px"},on:{change:e.searchHandle},model:{value:e.search.type,callback:function(t){e.$set(e.search,"type",t)},expression:"search.type"}},[a("el-radio",{attrs:{label:""}},[e._v("全部")]),a("el-radio",{attrs:{label:"replace"}},[e._v("替换")]),a("el-radio",{attrs:{label:"warning"}},[e._v("禁止发布")])],1)],1)],1)],1)],2)},r=[],i=a("11c1"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{top:"8vh",visible:e.visible,"show-close":!1,"close-on-click-modal":!1,title:e.action+"敏感词",width:"600px"},on:{"update:visible":function(t){e.visible=t}}},[a("el-form",{ref:"dataForm",staticClass:"m-auto",staticStyle:{width:"450px"},attrs:{model:e.dataForm,rules:e.dataRule,"label-width":"95px","label-suffix":":"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.dataFormSubmit()}}},[a("el-form-item",{attrs:{prop:"id"}}),a("el-form-item",{attrs:{prop:"word",label:"敏感词"}},[a("el-input",{attrs:{placeholder:"请输入敏感词",clearable:""},model:{value:e.dataForm.word,callback:function(t){e.$set(e.dataForm,"word",t)},expression:"dataForm.word"}})],1),"replace"===e.dataForm.type?a("el-form-item",{attrs:{prop:"replace",label:"替换词"}},[a("el-input",{attrs:{placeholder:"请输入替换词",clearable:""},model:{value:e.dataForm.replace,callback:function(t){e.$set(e.dataForm,"replace",t)},expression:"dataForm.replace"}})],1):e._e(),a("el-form-item",{attrs:{prop:"type",label:"操作类型",required:""}},[a("el-radio-group",{model:{value:e.dataForm.type,callback:function(t){e.$set(e.dataForm,"type",t)},expression:"dataForm.type"}},[a("el-radio",{attrs:{label:"warning"}},[e._v("禁止发布")]),a("el-radio",{attrs:{label:"replace"}},[e._v("替换")])],1)],1)],1),a("span",{attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.dataFormSubmit()}}},[e._v("确定")])],1)],1)},s=[],o=a("a8db"),c=a("c1fb");function d(e){return c["a"].get("sensitive",{params:e})}function u(e){var t=e.id,a=Object(o["a"])(e,["id"]),n={data:a,url:"sensitive/".concat(t||""),method:t?"PUT":"POST"};return Object(c["a"])(n)}function p(e){return c["a"].delete("sensitive/".concat(e))}function h(e){var t=new FormData;return t.append("file",e),c["a"].post("sensitive/import",t,{headers:{"Content-Type":"multipart/form-data"}})}var f=a("ed08"),m={name:"SensitiveAddOrUpdate",inject:["updateTableData"],data:function(){return{visible:!1,dataForm:{id:0,word:"",type:"warning",replace:""},dataRule:{word:[{required:!0,message:"敏感词不能为空",trigger:"blur"}],replace:[{required:!0,message:"代替词不能为空",trigger:"blur"}]}}},computed:{action:function(){return this.dataForm.id?"修改":"新增"}},methods:{init:function(e){var t=this;this.visible=!0,this.$nextTick(function(){t.$refs["dataForm"].resetFields(),e&&e.id&&Object(f["a"])(t.dataForm,e)})},dataFormSubmit:function(){var e=this;this.submitting||(this.submitting=!0,this.$refs["dataForm"].validate(function(t){t?("warning"===e.dataForm.type&&(e.dataForm.replace=""),u(e.dataForm).then(function(t){var a=t.message,n=void 0===a?"".concat(e.action,"成功！"):a;e.$message.success(n),e.visible=!1,e.updateTableData()}).catch(function(t){var a=t.message,n=void 0===a?"".concat(e.action,"失败！"):a;e.$message.error(n)}).finally(function(){e.submitting=!1})):e.submitting=!1}))}}},g=m,v=a("2877"),b=Object(v["a"])(g,l,s,!1,null,null,null),w=b.exports,y={name:"Sensitive",components:{addOrUpdate:w,listWithSearch:i["a"]},provide:function(){return{updateTableData:this.updateTableData}},data:function(){return{search:{word:"",type:""},typeOpt:{replace:{tag:"success",name:"替换"},warning:{tag:"danger",name:"禁止发布"}},addOrUpdateVisible:!1,loading:!1}},methods:{remoteMethod:d,searchHandle:function(){this.$refs["wrapper"].searchHandle()},updateTableData:function(){this.$refs["wrapper"]["updateDataHandle"]()},addOrUpdateHandle:function(e){var t=this;this.addOrUpdateVisible=!0,this.$nextTick(function(){t.$refs.addOrUpdate.init(e)})},deleteHandle:function(e){var t=this,a=e.id,n=e.word;this.$confirm("确定对铭感词「".concat(n,"」进行删除操作？"),"删除敏感词",{type:"warning"}).then(function(){p(a).then(function(e){var a=e.message,n=void 0===a?"删除成功":a;t.$message.success(n),t.updateTableData()}).catch(function(e){var a=e.message,n=void 0===a?"删除失效！":a;t.$message.error(n)})}).catch(f["i"])},exportOrImportHandle:function(e){if(!this.loading){if(this.loading=!0,"export"===e)return this.loading=!1,this.$refs["sensitive"].click();this.$refs.fileInput.click(),this.loading=!1}},fileChangeHandle:function(e){var t=this;if(!this.loading){this.loading=!0;var a=e.target.files||e.dataTransfer.files;h(a[0]).then(function(e){var a=e.message,n=void 0===a?"导入成功":a;t.$message.success(n),t.$refs.fileInput.value="",t.updateTableData()}).catch(function(e){var a=e.message,n=void 0===a?"导入失败！":a;t.$refs.fileInput.value="",t.$message.error(n)}).finally(function(){t.loading=!1})}}}},x=y,k=Object(v["a"])(x,n,r,!1,null,null,null);t["default"]=k.exports}}]);