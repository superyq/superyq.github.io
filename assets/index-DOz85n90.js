import{g as N,h as E,r as p,B as U,K as Y,J as d,W as R,F as l,N as $,M as q,aW as A,aX as B,t as C,aY as W,U as I,C as S,ai as F,o as O,D as w,a3 as j,am as M,aj as z,ak as H,al as J}from"./index-_v_ROuBL.js";import{_ as L}from"./YDate.vue_vue_type_script_setup_true_lang-oR0ZZS3_.js";import{_ as X}from"./YSelect.vue_vue_type_script_setup_true_lang-BhcyAp_T.js";import{_ as D}from"./YInput.vue_vue_type_script_setup_true_lang-C2uzhNBd.js";import{_ as G}from"./YTable.vue_vue_type_script_setup_true_lang-BQ6OwsLK.js";import{c as Q,e as K,f as Z,h as ee,i as te}from"./dict-Ozh2n2X6.js";import{u as ae,a as le,c as oe,b as ne}from"./table-a_mX3Frg.js";import{_ as se}from"./YSwitch.vue_vue_type_script_setup_true_lang-CEa3yXqL.js";import{_ as re}from"./YRadio.vue_vue_type_script_setup_true_lang-B28a7mRJ.js";import{N as x,_ as de}from"./FormItem-BtzGq-Ay.js";import"./use-keyboard-Bv3MiPgx.js";import"./Checkbox-CY6MvvVb.js";import"./RadioGroup-C0TaMrjb.js";import"./Dropdown-Ct-AoJJL.js";const ue=N({__name:"Search",props:{modelValue:{type:Object,required:!0}},emits:["update:modelaValue","search"],setup(T,{expose:n,emit:h}){const s=T,i=h,a=E({get(){return s.modelValue},set(o){i("update:modelaValue",o)}}),f=[{label:"启用",value:1},{label:"禁用",value:0}];let m=p(null);const _=()=>{i("search")},y=o=>{let e=a.value;if(o){let r=o.map(g=>A(g,"{y}-{m}-{d}"));e=B(a.value,r)}else e.params&&delete e.params;i("update:modelaValue",e)};return n({resetSearch:()=>{m.value=null}}),(o,e)=>{const r=D,g=X,u=L;return U(),Y(q,null,[d(r,{modelValue:a.value.dictName,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value.dictName=t),onKeyup:R(_,["enter"]),placeholder:"请输入字典名称"},null,8,["modelValue"]),d(r,{modelValue:a.value.dictType,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.dictType=t),onKeyup:R(_,["enter"]),placeholder:"请输入字典类型"},null,8,["modelValue"]),d(g,{modelValue:a.value.status,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.status=t),options:f,onKeyup:R(_,["enter"]),placeholder:"请选择字典状态"},null,8,["modelValue"]),d(u,{width:"300px",modelValue:l(m),"onUpdate:modelValue":e[3]||(e[3]=t=>$(m)?m.value=t:m=t),"onUpdate:value":y,"start-placeholder":"创建开始时间","end-placeholder":"创建结束时间"},null,8,["modelValue"])],64)}}}),ie=N({__name:"Table",props:{params:{type:Object,required:!0}},emits:["edit","delarr"],setup(T,{expose:n,emit:h}){const s=T,i=h,a=ae(),f=ne("dictId"),m=le([a.selectionColumn,{title:"字典编号",key:"dictId",width:80},{title:"字典名称",key:"dictName",minWidth:120},{title:"字典类型",key:"dictType",minWidth:120,render(t){return C(W,{to:`/dicttype/${t.dictId}`},{default:()=>t.dictType})}},{title:"备注",key:"remark"},{title:"创建时间",key:"createTime"},{title:"状态",key:"status",width:80,render(t){return C(se,{defaultValue:t.status,checkedValue:1,uncheckedValue:0,onUpdateValue:k=>{Q({id:t.id,status:k}).then(V=>{window.$msg.success(V.data)})}})}},{title:"操作",key:"action",fixed:"right",width:160,render(t){return oe([{label:"修改",icon:"edit",onClick:_.bind(null,t)},{label:"删除",icon:"delete",onClick:y.bind(null,t)}])}}],{align:"center"}),_=t=>{i("edit",t)},y=t=>{window.$dialog.warning({title:"警告",content:`确定删除 '${t.dictName}' ?`,positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{K(t.dictId).then(()=>{window.$msg.success("删除成功"),e()})}})};let v=p(!1),o=I([]);const e=()=>(v.value=!0,new Promise(t=>{Z(s.params).then(k=>{v.value=!1,o=k.data.data,t(k.data.total)})})),r=[],g=t=>{r.length=0,r.push(...t)};return n({getTable:e,delArr:()=>{if(!r.length)return window.$msg.info("请选择删除项");window.$dialog.warning({title:"警告",content:"确定批量删除?",positiveText:"确定",negativeText:"取消",onPositiveClick:()=>{K().then(()=>{window.$msg.success("删除成功"),e()})}})}}),(t,k)=>{const V=G;return U(),S(V,{loading:l(v),columns:l(m),data:l(o),"row-key":l(f),"onUpdate:checkedRowKeys":g},null,8,["loading","columns","data","row-key"])}}}),me=N({__name:"Form",props:{formId:[Number,String]},setup(T,{expose:n}){const h=T,s=[{label:"启动",value:1},{label:"停用",value:0}];let i={dictId:void 0,dictName:void 0,dictType:void 0,status:"0",remark:void 0},a=p(F(i));const f={dictName:[{required:!0,message:"字典名称不能为空",trigger:"blur"}],dictType:[{required:!0,message:"字典类型不能为空",trigger:"blur"}]},m=()=>{ee(h.formId).then(o=>{a.value=o.data})};let _=p(null);const y=()=>{a.value=F(i)};return n({validateForm:()=>new Promise((o,e)=>{_.value.validate(r=>{r?e(!1):te(a.value).then(()=>{window.$msg.success(`${a.value.userId?"修改":"新增"}字典成功！`),o(!0)}).catch(()=>{e(!1)})})})}),O(()=>{y(),h.formId&&m()}),(o,e)=>{const r=re,g=de;return U(),S(g,{ref_key:"formRef",ref:_,model:l(a),rules:f,"label-placement":"left","require-mark-placement":"left","label-width":"80"},{default:w(()=>[d(l(x),{path:"dictName",label:"字典名称"},{default:w(()=>[d(D,{modelValue:l(a).dictName,"onUpdate:modelValue":e[0]||(e[0]=u=>l(a).dictName=u)},null,8,["modelValue"])]),_:1}),d(l(x),{path:"dictType",label:"字典类型"},{default:w(()=>[d(D,{modelValue:l(a).dictType,"onUpdate:modelValue":e[1]||(e[1]=u=>l(a).dictType=u)},null,8,["modelValue"])]),_:1}),d(l(x),{path:"status",label:"状态"},{default:w(()=>[d(r,{modelValue:l(a).status,"onUpdate:modelValue":e[2]||(e[2]=u=>l(a).status=u),options:s},null,8,["modelValue"])]),_:1}),d(l(x),{path:"remark",label:"备注",style:{"grid-area":"6 / 1 / 10 / 3"}},{default:w(()=>[d(D,{width:"auto",type:"textarea",modelValue:l(a).remark,"onUpdate:modelValue":e[3]||(e[3]=u=>l(a).remark=u)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])}}}),ce=j(me,[["__scopeId","data-v-37e63efb"]]),Ie=N({__name:"index",setup(T){let n=I({dictName:"",dictType:"",status:null}),h=p(null),s=I(M),i=E(()=>Object.assign({},n,s));const a=p(null),f=(V=1)=>{s.page=V,a.value.getTable().then(c=>{s.total=c})},m=I({del:!0,export:!0,import:!1}),_=()=>{n.dictName="",n.dictType="",n.status=null,h.value.resetSearch(),n.params&&delete n.params,s.page=1,s.pageSize=20,f()};let y=p(""),v=p(!1),o=p(!1),e=p(null),r=p("");const g=(V=null)=>{const c=!!V;r.value=c?V.dictId:"",y.value=`${c?"编辑":"新增"}字典`,o.value=!0},u=()=>{v.value=!0,e.value.validateForm().then(()=>{o.value=!1}).catch(()=>{}).finally(()=>{v.value=!1})},t=()=>{a.value.delArr()},k=()=>{H("system/user/export",{...i},`user_${new Date().getTime()}.xlsx`)};return z("btnload",v),O(()=>{f()}),(V,c)=>{const P=J;return U(),S(P,{title:l(y),controlShow:m,modelValue:l(s),"onUpdate:modelValue":c[1]||(c[1]=b=>$(s)?s.value=b:s=b),show:l(o),"onUpdate:show":c[2]||(c[2]=b=>$(o)?o.value=b:o=b),onAdd:g,onSearch:f,onReset:_,onDel:t,onSubmit:u,onExport:k},{search:w(()=>[d(ue,{ref_key:"searchRef",ref:h,modelValue:l(n),"onUpdate:modelValue":c[0]||(c[0]=b=>$(n)?n.value=b:n=b),onSearch:f},null,8,["modelValue"])]),table:w(()=>[d(ie,{ref_key:"table",ref:a,params:l(i),onEdit:g},null,8,["params"])]),form:w(()=>[d(ce,{ref_key:"form",ref:e,formId:l(r)},null,8,["formId"])]),_:1},8,["title","controlShow","modelValue","show"])}}});export{Ie as default};
